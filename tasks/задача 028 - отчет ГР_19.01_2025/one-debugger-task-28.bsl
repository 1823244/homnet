Перем ИмяГруппы;
Перем	мНачалоПериода;
Перем	мКонецПериода;
Перем	мСтруктураПараметров;
Перем	мВыводитьСообщения;
Перем мЗначениеПоказателя;

#Область ПодключениеОбработкиКБСП

Функция СведенияОВнешнейОбработке() Экспорт

	ПараметрыРегистрации = ДополнительныеОтчетыИОбработки.СведенияОВнешнейОбработке();

	ПараметрыРегистрации.Вставить("Вид",ДополнительныеОтчетыИОбработкиКлиентСервер.ВидОбработкиДополнительнаяОбработка());
	ПараметрыРегистрации.Вставить("Версия","1.3");
	//ПараметрыРегистрации.Вставить("Назначение", Новый Массив);
	ПараметрыРегистрации.Вставить("Наименование","Отчет19012025");
	ПараметрыРегистрации.Вставить("БезопасныйРежим", Ложь);
	ПараметрыРегистрации.Вставить("Информация","Отчет 19.01_2025");
	ПараметрыРегистрации.Вставить("ВерсияБСП", "3.1.5.180");
	//ПараметрыРегистрации.Вставить("ОпределитьНастройкиФормы", Ложь);

	ТипКоманды = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыОткрытиеФормы();
	ДобавитьКоманду(ПараметрыРегистрации.Команды,
		"Открыть форму : Отчет 19.01_2025",
		"Форма_Отчет19012025",
		ТипКоманды,
		Ложь) ;
	//	
	//ТипКоманды = ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКомандыВызовСерверногоМетода();
	//ДобавитьКоманду(ПараметрыРегистрации.Команды, 
	//	"Выполнить отложенное проведение",
	//	"ВыполнитьОтложенноеПроведение",
	//	ТипКоманды, 
	//	Ложь) ;

	Возврат ПараметрыРегистрации;
	
КонецФункции

Процедура ДобавитьКоманду(ТаблицаКоманд, Представление, Идентификатор, Использование, ПоказыватьОповещение = Ложь, Модификатор = "")

	//ТаблицаКоманд.Колонки.Добавить("Представление", РеквизитыТабличнойЧасти.Представление.Тип);
	//ТаблицаКоманд.Колонки.Добавить("Идентификатор", РеквизитыТабличнойЧасти.Идентификатор.Тип);
	//ТаблицаКоманд.Колонки.Добавить("Использование", Новый ОписаниеТипов("Строка"));
	//ТаблицаКоманд.Колонки.Добавить("ПоказыватьОповещение", РеквизитыТабличнойЧасти.ПоказыватьОповещение.Тип);
	//ТаблицаКоманд.Колонки.Добавить("Модификатор", РеквизитыТабличнойЧасти.Модификатор.Тип);
	//ТаблицаКоманд.Колонки.Добавить("Скрыть",      РеквизитыТабличнойЧасти.Скрыть.Тип);
	//ТаблицаКоманд.Колонки.Добавить("ЗаменяемыеКоманды", РеквизитыТабличнойЧасти.ЗаменяемыеКоманды.Тип);
	
//           ** Использование - Строка - тип команды:
//               "ВызовКлиентскогоМетода",
//               "ВызовСерверногоМетода",
//               "ЗаполнениеФормы",
//               "ОткрытиеФормы" или
//               "СценарийВБезопасномРежиме".
//               Для получения типов команд рекомендуется использовать функции
//               ДополнительныеОтчетыИОбработкиКлиентСервер.ТипКоманды<ИмяТипа>.
//               В комментариях к этим функциям также даны шаблоны процедур-обработчиков команд.

	НоваяКоманда = ТаблицаКоманд.Добавить() ;
	НоваяКоманда.Представление = Представление ;
	НоваяКоманда.Идентификатор = Идентификатор ;
	НоваяКоманда.Использование = Использование ;
	НоваяКоманда.ПоказыватьОповещение = ПоказыватьОповещение ;
	НоваяКоманда.Модификатор = Модификатор ;
КонецПроцедуры

// Интерфейс для запуска логики обработки.
Процедура ВыполнитьКоманду(ИмяКоманды, ПараметрыВыполнения) Экспорт
	
	Если ИмяКоманды = "ВыполнитьОтложенноеПроведение" Тогда
		//ВыполнитьОтложенноеПроведение();
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

// Назначение: Основная процедура запуска создания всех показателей отчета ГР 19.01.2025
// Параметры: ВыводитьСообщения - Булево - Флаг вывода диагностических сообщений
// Операции с БД: Создание группы показателей, массовое создание элементов справочника
// Валидация: Проверка существования группы и показателей
Процедура СоздатьОбновитьПоказатели(Знач ВыводитьСообщения = Истина) Экспорт
 
	#region initialization
	
	Если ВыводитьСообщения Тогда
		Сообщить("<operation_start>Начало создания показателей отчета ГР 19.01.2025</operation_start>");
	КонецЕсли;
	
	#endregion
	
	#region group_preparation
	
	СоздатьГруппуПоказателей(ВыводитьСообщения);
	ПометитьВсеПоказателиНаУдаление(ВыводитьСообщения);
	
	#endregion

	СоздатьПоказателиСтроки2(ВыводитьСообщения);
	СоздатьПоказателиСтроки3(ВыводитьСообщения);

	// сумма строк
	СоздатьПоказателиСтроки1(ВыводитьСообщения);

	//
	//СоздатьПоказателиСтроки5(ВыводитьСообщения);
	//
	//
	//СоздатьПоказателиСтроки9(ВыводитьСообщения);	
	//СоздатьПоказателиСтроки10(ВыводитьСообщения);	
	//// сумма строк
	//СоздатьПоказателиСтроки8(ВыводитьСообщения);

	//
	//СоздатьПоказателиСтроки12(ВыводитьСообщения);	
	//
	////// сумма строк - но строки 14 и 15 в моем ТЗ - не имеют формул
	////СоздатьПоказателиСтроки13(ВыводитьСообщения);

	////// сумма строк - но строки 17 и 18 в моем ТЗ - не имеют формул
	////СоздатьПоказателиСтроки16(ВыводитьСообщения);
	////
	////// сумма строк - но строки 20 и 21 в моем ТЗ - не имеют формул
	////СоздатьПоказателиСтроки19(ВыводитьСообщения);

	//
	////// сумма строк - 
	//СоздатьПоказателиСтроки23(ВыводитьСообщения);
	//
	//СоздатьПоказателиСтроки24(ВыводитьСообщения);	
	//СоздатьПоказателиСтроки25(ВыводитьСообщения);	
	//
	//СоздатьПоказателиСтроки28(ВыводитьСообщения);	
	//СоздатьПоказателиСтроки29(ВыводитьСообщения);	

	////// Бал стоим. сумма строк - 28+29+30  (30 - нет формул)
	//СоздатьПоказателиСтроки27(ВыводитьСообщения);

	//СоздатьПоказателиСтроки31(ВыводитьСообщения);	

	//СоздатьПоказателиСтроки35(ВыводитьСообщения);	
	//СоздатьПоказателиСтроки36(ВыводитьСообщения);	

	////// сумма строк - 35+36+37  (37 - нет формул)
	//СоздатьПоказателиСтроки34(ВыводитьСообщения);
	//
	//СоздатьПоказателиСтроки38(ВыводитьСообщения);	

	////// сумма строк - 40+41   - нет формул
	////СоздатьПоказателиСтроки39(ВыводитьСообщения);
	////
	////// сумма строк - 43+44   - нет формул
	////СоздатьПоказателиСтроки42(ВыводитьСообщения);
	////
	////// сумма строк - 46+47   - нет формул
	////СоздатьПоказателиСтроки45(ВыводитьСообщения);

	////// Бал стоим
	//СоздатьПоказателиСтроки49(ВыводитьСообщения);
	//
	//СоздатьПоказателиСтроки50(ВыводитьСообщения);
	//
	//СоздатьПоказателиСтроки51(ВыводитьСообщения);

	#region operation_completion
	
	Если ВыводитьСообщения Тогда
		Сообщить("<operation_end>Завершено создание показателей отчета ГР_18.1_2025</operation_end>");
	КонецЕсли;
	
	#endregion

КонецПроцедуры

// Назначение: Создание группы показателей 
// Параметры: ВыводитьСообщения - Булево - Флаг вывода диагностических сообщений
// Операции с БД: Создание элемента справочника-группы
// Валидация: Проверка существования группы перед созданием
Процедура СоздатьГруппуПоказателей(Знач ВыводитьСообщения = Ложь)

	#region initialization
	
	Идентификатор = ИмяГруппы;
	НаименованиеГруппы = ИмяГруппы;
	
	#endregion
	
	#region validation
	
	ГруппаСсылка = Справочники.хн_нфо_ПоказателиОтчета.НайтиПоНаименованию(НаименованиеГруппы,истина);
	
	#endregion
	
	#region group_creation
	
	Если НЕ ЗначениеЗаполнено(ГруппаСсылка) Тогда
		
		ГруппаОбъект = Справочники.хн_нфо_ПоказателиОтчета.СоздатьГруппу();
		ГруппаОбъект.Идентификатор = Идентификатор;
		ГруппаОбъект.Наименование = НаименованиеГруппы;
		ГруппаОбъект.Записать();
		
		Если ВыводитьСообщения Тогда
			Сообщить("<data_summary>Создана группа показателей: " + НаименованиеГруппы+ "</data_summary>");
		КонецЕсли;
		
	Иначе
		
		Если ВыводитьСообщения Тогда
			Сообщить("<validation_result>Группа показателей уже существует: " + НаименованиеГруппы + "</validation_result>");
		КонецЕсли;
		
	КонецЕсли;
	
	#endregion

КонецПроцедуры

// Назначение: Пометка всех показателей группы на удаление
// Параметры: ВыводитьСообщения - Булево - Флаг вывода диагностических сообщений
// Операции с БД: Обновление пометки удаления элементов справочника
// Производительность: Пакетная обработка через запрос
Процедура ПометитьВсеПоказателиНаУдаление(Знач ВыводитьСообщения = Ложь)

	#region initialization

	#endregion
	
	#region database_query
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ
	|	хн_нфо_ПоказателиОтчета.Ссылка КАК Ссылка
	|ИЗ
	|	Справочник.хн_нфо_ПоказателиОтчета КАК хн_нфо_ПоказателиОтчета
	|ГДЕ
	|	хн_нфо_ПоказателиОтчета.Родитель = &Родитель
	|	И НЕ хн_нфо_ПоказателиОтчета.ПометкаУдаления";
	
	ГруппаСсылка = Справочники.хн_нфо_ПоказателиОтчета.НайтиПоНаименованию(ИмяГруппы, Истина);
	Если не ЗначениеЗаполнено(ГруппаСсылка) Тогда
		ВызватьИсключение "Группа не найдена: "+ИмяГруппы;
	КонецЕсли;
	Запрос.УстановитьПараметр("Родитель", ГруппаСсылка);
	
	Результат = Запрос.Выполнить();
	
	#endregion
	
	#region loop_processing
	
	КоличествоПомеченных = 0;
	Выборка = Результат.Выбрать();
	
	Пока Выборка.Следующий() Цикл
		
		ПоказательОбъект = Выборка.Ссылка.ПолучитьОбъект();
		//ПоказательОбъект.УстановитьПометкуУдаления(Истина);
		ПоказательОбъект.ПометкаУдаления = Истина;
		ПоказательОбъект.Записать();
		КоличествоПомеченных = КоличествоПомеченных + 1;
		
	КонецЦикла;
	
	#endregion
	
	#region result_formation
	
	Если ВыводитьСообщения Тогда
		Сообщить("<data_summary>Помечено на удаление показателей: " + КоличествоПомеченных + "</data_summary>");
	КонецЕсли;
	
	#endregion

КонецПроцедуры

// ГЛАВНЫЙ МЕТОД ОБРАБОТКИ!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
Процедура СоздатьИлиОбновитьПоказатель(
	Идентификатор,
	НаименованиеПоказателя,
	ВидПоказателя,
	ТипПоказателяОтчета,
	ОписаниеПоказателя,
	СписокИспользуемыхПоказателей = "",
	ЗначениеОтбора = Неопределено,
	Знач ВыводитьСообщения = Ложь,
	ТекстКода = "",
	Формула = "",
	Множитель = 1)
	
	#region initialization

	#endregion
	
	#region validation
	
	ГруппаСсылка = Справочники.хн_нфо_ПоказателиОтчета.НайтиПоНаименованию(ИмяГруппы, Истина);
	Если НЕ ЗначениеЗаполнено(ГруппаСсылка) Тогда
		
		Если ВыводитьСообщения Тогда
			Сообщить("<error_details>Ошибка: Группа " + ИмяГруппы + " не найдена</error_details>");
		КонецЕсли;
		Возврат;
		
	КонецЕсли;
	
	ПоказательСсылка = Справочники.хн_нфо_ПоказателиОтчета.НайтиПоНаименованию(НаименованиеПоказателя, Истина);
	
	#endregion
	
	#region indicator_creation
	
	Если НЕ ЗначениеЗаполнено(ПоказательСсылка) Тогда
		ПоказательОбъект = Справочники.хн_нфо_ПоказателиОтчета.СоздатьЭлемент();
	Иначе
		ПоказательОбъект = ПоказательСсылка.ПолучитьОбъект();
	КонецЕсли;
	
	#endregion
	
	#region data_processing
	
	// Заполнение основных атрибутов
	ПоказательОбъект.Наименование = НаименованиеПоказателя;
	ПоказательОбъект.Родитель = ГруппаСсылка;

	ПоказательОбъект.Идентификатор = Идентификатор;
	ПоказательОбъект.ВидПоказателя = ВидПоказателя;
	ПоказательОбъект.Формула = Формула;
	ПоказательОбъект.ОписаниеПоказателя = ОписаниеПоказателя;
	ПоказательОбъект.НеВыводитьВОтчет = Ложь;
	ПоказательОбъект.ТекстКода = ТекстКода;
	ПоказательОбъект.Множитель = Множитель;
	ПоказательОбъект.ВалютаПоказателя = Undefined;
	
	ПоказательОбъект.ФорматДаты = "";
	ПоказательОбъект.ТипРегистратора = "";
	ПоказательОбъект.ТипПоказателяОтчета = ТипПоказателяОтчета;
	
	// Заполнение атрибутов в зависимости от вида показателя
	Если ВидПоказателя = Перечисления.хн_нфо_ВидыПоказателейОтчета.РасчетПоФормуле Тогда
		
		ПоказательОбъект.Регистр = "";
		ПоказательОбъект.Ресурс = "";
		ПоказательОбъект.ТипПоказателя = 1; // Строка для формульных
		
	Иначе
		
		ПоказательОбъект.ТипПоказателя = 0; // Число
		ПоказательОбъект.Регистр = "Хозрасчетный";
		
		Если ТипПоказателяОтчета = Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало Тогда
			ПоказательОбъект.Ресурс = "СуммаНачальныйОстаток";
		ИначеЕсли ТипПоказателяОтчета = Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец Тогда
			ПоказательОбъект.Ресурс = "СуммаКонечныйОстаток";
		ИначеЕсли ТипПоказателяОтчета = Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод Тогда
			ПоказательОбъект.Ресурс = "СуммаОборот";
		КонецЕсли;
		
	КонецЕсли;
	
	#endregion
	
	#region tabular_section_processing
	
	// Заполнение табличной части для формульных показателей
	Если ВидПоказателя = Перечисления.хн_нфо_ВидыПоказателейОтчета.РасчетПоФормуле
		И НЕ ПустаяСтрока(СписокИспользуемыхПоказателей) Тогда
		
		ПоказательОбъект.ИспользуемыеПоказатели.Очистить();
		
		МассивИмен = СтрРазделить(СписокИспользуемыхПоказателей, ",", Ложь);
		Для каждого ИмяИспользуемого Из МассивИмен Цикл
			
			ИмяИспользуемого = СокрЛП(ИмяИспользуемого);
			ИспользуемыйПоказатель = Справочники.хн_нфо_ПоказателиОтчета.НайтиПоНаименованию(ИмяИспользуемого, Истина);
			
			Если ЗначениеЗаполнено(ИспользуемыйПоказатель) Тогда
				
				НоваяСтрока = ПоказательОбъект.ИспользуемыеПоказатели.Добавить();
				НоваяСтрока.Показатель = ИспользуемыйПоказатель;
				НоваяСтрока.Множитель = Множитель;
				
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЕсли;
	
	#endregion
	
	#region database_write
	
	//ПоказательОбъект.УстановитьПометкуУдаления(Ложь);
	ПоказательОбъект.ПометкаУдаления = Ложь;
	ПоказательОбъект.Записать();
	
	#endregion
	
	#region result_formation
	
	Если ВыводитьСообщения Тогда
		Сообщить("<data_summary>Создан/обновлен показатель: " + НаименованиеПоказателя + "</data_summary>");
	КонецЕсли;
	
	#endregion

КонецПроцедуры

// Универсальный метод вычисления показателя в зависимости от номера строки и колонки
Функция ВычислитьПоказатель(НомерСтроки, НомерКолонки, пНачалоПериода, пКонецПериода, пСтруктураПараметров, Знач пВыводитьСообщения = Ложь) Экспорт
	              
	мНачалоПериода = пНачалоПериода;
	мКонецПериода = пКонецПериода;
	мСтруктураПараметров = пСтруктураПараметров;
	мВыводитьСообщения = пВыводитьСообщения;
	Выражение = "ВычислитьПоказатель_стр"+Формат(НомерСтроки,"ЧГ=;ЧРГ=")+"кол"+Формат(НомерКолонки,"ЧГ=;ЧРГ=")+"()";
	сообщить(Выражение);
	Выполнить(Выражение);
	
	Возврат мЗначениеПоказателя;

КонецФункции

#Область АналитикаОстатковИОборотов

Функция ПолучитьМассивСубконто(ГруппаОС) Экспорт
	//МассивСубконто=ПолучитьМассивСубконто(Перечисления.ГруппыОС.Сооружения);
	//МассивСубконто=ПолучитьМассивСубконто(Перечисления.ГруппыОС.ОфисноеОборудование );
	//МассивСубконто=ПолучитьМассивСубконто(Перечисления.ГруппыОС.ДругиеВидыОсновныхСредств );

	запрос=новый запрос("Выбрать ссылка из справочник.ОсновныеСредства где ГруппаОС = &ГруппаОС");
	запрос.установитьпараметр("ГруппаОС",ГруппаОС);
	ТЗ=запрос.выполнить().выгрузить();
	массивСсылок=ТЗ.ВыгрузитьКолонку("Ссылка");
	Возврат массивСсылок;

КонецФункции

Функция ГруппаОС_Сооружения() Экспорт
	возврат  ПолучитьМассивСубконто(Перечисления.ГруппыОС.Сооружения);
КонецФункции

Функция ГруппаОС_ОфисноеОборудование() Экспорт
	возврат  ПолучитьМассивСубконто(Перечисления.ГруппыОС.ОфисноеОборудование);
КонецФункции

Функция ГруппаОС_Другие() Экспорт
	возврат  ПолучитьМассивСубконто(Перечисления.ГруппыОС.ДругиеВидыОсновныхСредств);
КонецФункции

#КонецОбласти

// Параметры:
//	Организация - спр ссылка
//	СчетСсылка - план счетов Хозрасчетный
//	МассивСсылок - массив - ссылки на субконто, спр НематериальныеАктивы
//	_НачалоПериода - дата
//	_КонецПериода - дата
//	ЭтоДебетовыйОборот - булево - управляет видом оборота: по Дт или по Кт
//
Функция ОборотыПоСчету(Организация, СчетСсылка, МассивСсылок, _НачалоПериода, _КонецПериода, ЭтоДебетовыйОборот=Истина) Экспорт
	
	Запрос = Новый Запрос;
	Запрос.Текст =
		"ВЫБРАТЬ
		|	СУММА(ХозрасчетныйОстаткиИОбороты.СуммаОборот) КАК СуммаОборот,
		|	СУММА(ХозрасчетныйОстаткиИОбороты.СуммаОборотДт) КАК СуммаОборотДт,
		|	СУММА(ХозрасчетныйОстаткиИОбороты.СуммаОборотКт) КАК СуммаОборотКт,
		|	СУММА(ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаОборот) КАК ВалютнаяСуммаОборот,
		|	СУММА(ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаОборотДт) КАК ВалютнаяСуммаОборотДт,
		|	СУММА(ХозрасчетныйОстаткиИОбороты.ВалютнаяСуммаОборотКт) КАК ВалютнаяСуммаОборотКт
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.ОстаткиИОбороты(
		|			&НачалоПериода,
		|			&КонецПериода,
		|			Период,
		|			,
		|			Счет В ИЕРАРХИИ (&Счет),
		|			,
		|			Организация = &Организация
		|				И &УсловиеНаСубконто) КАК ХозрасчетныйОстаткиИОбороты";

	Запрос.УстановитьПараметр("НачалоПериода", НачалоДня(_НачалоПериода));
	Запрос.УстановитьПараметр("КонецПериода", КонецДня(_КонецПериода));
	Запрос.УстановитьПараметр("Организация", Организация);
	Если МассивСсылок = Неопределено Тогда
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&УсловиеНаСубконто", "1=1");
	Иначе
		
		Если МассивСсылок.Количество() > 0  Тогда
		
			Запрос.УстановитьПараметр("Субконто1", МассивСсылок);
		    Запрос.Текст = СтрЗаменить(Запрос.Текст, "&УсловиеНаСубконто", "Субконто1 В (&Субконто1)");
			
		Иначе
			
			Запрос.Текст = СтрЗаменить(Запрос.Текст, "&УсловиеНаСубконто", "1=1");
			
		КонецЕсли;
	
	КонецЕсли;
	Запрос.УстановитьПараметр("Счет", СчетСсылка);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Если ЭтоДебетовыйОборот Тогда
		
			возврат ВыборкаДетальныеЗаписи.СуммаОборотДт;
		
		Иначе
			
			возврат ВыборкаДетальныеЗаписи.СуммаОборотКт;
		КонецЕсли;
		
	КонецЦикла;
	
	Возврат 0;
	
КонецФункции

// Параметры:
//	Организация - спр ссылка
//	СчетСсылка - план счетов Хозрасчетный
//	МассивСсылок - массив - ссылки на субконто, спр НематериальныеАктивы
//	ДатаОстатка - дата
//	ЭтоОстатокНаНачало - булево - управляет видом границы для регистра бухгалтерии
//
Функция ОстатокПоСчету(Организация, СчетСсылка, МассивСсылок, ДатаОстатка, ЭтоОстатокНаНачало=Истина) Экспорт

	Если ЭтоОстатокНаНачало=Истина Тогда

		Парам = Новый Массив(2);
		Парам[0] = НачалоДня(ДатаОстатка);
		Парам[1] = ВидГраницы.Исключая;
		Граница = Новый(Тип("Граница"),Парам);

	ИначеЕсли ЭтоОстатокНаНачало=Ложь Тогда

		Парам = Новый Массив(2);
		Парам[0] = КонецДня(ДатаОстатка);
		Парам[1] = ВидГраницы.Включая;
		Граница = Новый(Тип("Граница"),Парам);

	КонецЕсли;

	Запрос = Новый Запрос;
	Запрос.Текст =
		"ВЫБРАТЬ
		|	СУММА(ХозрасчетныйОстатки.СуммаОстаток) КАК СуммаОстаток,
		|	СУММА(ХозрасчетныйОстатки.СуммаОстатокДт) КАК СуммаОстатокДт,
		|	СУММА(ХозрасчетныйОстатки.СуммаОстатокКт) КАК СуммаОстатокКт,
		|	СУММА(ХозрасчетныйОстатки.ВалютнаяСуммаОстаток) КАК ВалютнаяСуммаОстаток,
		|	СУММА(ХозрасчетныйОстатки.ВалютнаяСуммаОстатокДт) КАК ВалютнаяСуммаОстатокДт,
		|	СУММА(ХозрасчетныйОстатки.ВалютнаяСуммаОстатокКт) КАК ВалютнаяСуммаОстатокКт
		|ИЗ
		|	РегистрБухгалтерии.Хозрасчетный.Остатки(
		|			&ДатаОстатка,
		|			Счет В ИЕРАРХИИ (&Счет),
		|			,
		|			Организация = &Организация
		|				И &УсловиеНаСубконто) КАК ХозрасчетныйОстатки";
	
	Запрос.УстановитьПараметр("ДатаОстатка", Граница);
	Запрос.УстановитьПараметр("Организация", Организация);
	Если МассивСсылок = Неопределено Тогда
		Запрос.Текст = СтрЗаменить(Запрос.Текст, "&УсловиеНаСубконто", "1=1");
	Иначе
		
		Если МассивСсылок.Количество() > 0  Тогда
		
			Запрос.УстановитьПараметр("Субконто1", МассивСсылок);
		    Запрос.Текст = СтрЗаменить(Запрос.Текст, "&УсловиеНаСубконто", "Субконто1 В (&Субконто1)");
			
		Иначе
			
			Запрос.Текст = СтрЗаменить(Запрос.Текст, "&УсловиеНаСубконто", "1=1");
			
		КонецЕсли;
	
	КонецЕсли;
	
	Запрос.УстановитьПараметр("Счет", СчетСсылка);
	
	РезультатЗапроса = Запрос.Выполнить();
	
	ВыборкаДетальныеЗаписи = РезультатЗапроса.Выбрать();
	
	Пока ВыборкаДетальныеЗаписи.Следующий() Цикл
		Возврат ВыборкаДетальныеЗаписи.СуммаОстаток;
	КонецЦикла;
	
	Возврат 0;
              
КонецФункции

Функция ПустаяТЗПоказателей()
			
	ТЗ = Новый ТаблицаЗначений();
	ТЗ.Колонки.Добавить("НомерСтроки");
	ТЗ.Колонки.Добавить("НомерКолонки");
	ТЗ.Колонки.Добавить("Идентификатор");
	ТЗ.Колонки.Добавить("НаименованиеПоказателя");
	ТЗ.Колонки.Добавить("ВидПоказателя");
	ТЗ.Колонки.Добавить("ТипПоказателяОтчета");
	ТЗ.Колонки.Добавить("ОписаниеПоказателя");
	ТЗ.Колонки.Добавить("СписокИспользуемыхПоказателей");
	ТЗ.Колонки.Добавить("ЗначениеОтбора");
	ТЗ.Колонки.Добавить("ТекстКода");
	ТЗ.Колонки.Добавить("Формула");
	ТЗ.Колонки.Добавить("Множитель");

	Возврат ТЗ;
	
КонецФункции

// не надо вызывать эту процедуру. это просто шаблон кода
Процедура ШаблонПустойСтрокиТЗ(ТЗ)
	
	// шаблон строки ТЗ
	стрк = ТЗ.Добавить();;
	стрк.Идентификатор 			= "";
	стрк.НаименованиеПоказателя = стрк.Идентификатор;
	стрк.ВидПоказателя 			= Неопределено;
	стрк.ТипПоказателяОтчета 	= Неопределено;
	стрк.ОписаниеПоказателя 	= "";
	стрк.СписокИспользуемыхПоказателей = "";
	стрк.ЗначениеОтбора 		= Неопределено;
	стрк.ТекстКода 				= Неопределено;
	стрк.Формула 				= Неопределено;
	стрк.Множитель 				= 1;
	
КонецПроцедуры

#Область СозданиеДетальныхПоказателей

// формирует строки с текстом программного кода детального показателя
Функция ТекстКодаДетальногоПоказателя(НомерСтроки, НомерКолонки)

	т = "
	|СсылкаОбработчика = Справочники.ДополнительныеОтчетыИОбработки
	|	.НайтиПоНаименованию(""Отчет19012025"",Истина);
    |ДополнительныеОтчетыИОбработки.ПодключитьВнешнююОбработку(СсылкаОбработчика);
	|ЗначениеПоказателя = ДополнительныеОтчетыИОбработки.ОбъектВнешнейОбработки(СсылкаОбработчика)
	|	.ВычислитьПоказатель("+Формат(НомерСтроки,"ЧГ=;ЧРГ=")+","+Формат(НомерКолонки,"ЧГ=;ЧРГ=")+", мНачалоПериода, мКонецПериода, СтруктураПараметров, Истина);
	|";
	
	Возврат т;
	
КонецФункции

// Длинная процедура, в которой добавляем все показатели в ТЗ
Процедура ДобавитьДетальныеПоказателиВТЗ(ТЗ)
	
	// предыдущий период
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 2;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 2;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 2;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 2;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 3;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 3;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 3;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 3;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 5;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 5;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 5;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 5;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 10;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 10;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 10;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 10;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 11;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 11;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 11;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 11;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 13;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 13;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 13;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 13;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 25;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 25;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 25;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 25;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 26;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 26;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 26;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 26;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	// текущий период
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 29;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 29;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 29;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 29;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 30;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 30;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 30;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 30;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 32;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 32;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 32;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 32;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 37;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 37;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 37;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 37;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 38;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 38;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 38;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 38;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 40;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 40;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 40;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 40;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 52;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 52;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 52;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 52;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 53;
	стрк.НомерКолонки			= 3;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 53;
	стрк.НомерКолонки			= 4;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 53;
	стрк.НомерКолонки			= 6;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 53;
	стрк.НомерКолонки			= 7;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;

КонецПроцедуры

// Универсальный метод создания детального показателя
Процедура СоздатьДетальныеПоказателиИзТЗ(ТЗ)
	
	Для Счетчик = 0 По ТЗ.Количество()-1 Цикл
		стрк = ТЗ[Счетчик];
				
		Идентификатор = "ГР_19_01_2025_стр"+Формат(стрк.НомерСтроки,"ЧГ=;ЧРГ=")+"кол"+Формат(стрк.НомерКолонки,"ЧГ=;ЧРГ=");
		ОписаниеПоказателя = "";
		
		СоздатьИлиОбновитьПоказатель(
			Идентификатор,
			Идентификатор,//стрк.НаименованиеПоказателя, 
			Перечисления.хн_нфо_ВидыПоказателейОтчета.ВычислениеНаВстроенномЯзыке,//стрк.ВидПоказателя, 
			стрк.ТипПоказателяОтчета,
			ОписаниеПоказателя,
			"",//стрк.СписокИспользуемыхПоказателей, 
			Неопределено, //стрк.ЗначениеОтбора,
			Истина,//выводить сообщения
			ТекстКодаДетальногоПоказателя(стрк.НомерСтроки, стрк.НомерКолонки),//стрк.ТекстКода,
			"",//стрк.Формула,
			1//Множитель
			);
		
	КонецЦикла;
	
КонецПроцедуры

// НОВАЯ ГЛАВНАЯ ПРОЦЕДУРА - создание показателей из ТЗ - ДЕТАЛЬНЫЕ (еще будут ГРУППИРОВОЧНЫЕ)
Процедура СоздатьВсеДетальныеПоказателиИзТЗ_Оркестратор()
	
	ТЗ = ПустаяТЗПоказателей();
	ДобавитьДетальныеПоказателиВТЗ(ТЗ);
	СоздатьДетальныеПоказателиИзТЗ(ТЗ);
	
КонецПроцедуры

#КонецОбласти

Функция ид(стрк, кол)
	
	Возврат "ГР_19_01_2025_стр"+Формат(стрк,"ЧГ=;ЧРГ=")+"кол"+Формат(кол,"ЧГ=;ЧРГ=");
	
КонецФункции

Функция список_ид_по_номеру_стрк(НомерСтроки)
	
	Возврат ид(НомерСтроки,3)+","+ид(НомерСтроки,4)+","+ид(НомерСтроки,6)+","+ид(НомерСтроки,7);
	
КонецФункции

#Область Создание+КОЛОНКИ12_для_всех_видов_показателей

// это вызывать в конце, после создания Детальных и Группировочных

// Длинная процедура, в которой добавляем все показатели в ТЗ
Процедура Добавить_Показатели_Колонки12_в_ТЗ(ТЗ)
	
	// предыдущий период
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 1;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 2;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 3;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 5;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 9;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 10;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 11;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 13;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 24;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 25;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 26;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	// текущий период
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 28;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 29;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 30;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаНачало;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 32;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 36;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);
	
	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 37;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 38;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 40;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОборотЗаПериод;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 51;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 52;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

	стрк = ТЗ.Добавить();;
	стрк.НомерСтроки			= 53;
	стрк.НомерКолонки			= 12;
	стрк.ТипПоказателяОтчета 	= Перечисления.хн_нфо_ТипПоказателяОтчета.ОстатокНаКонец;
	стрк.СписокИспользуемыхПоказателей = список_ид_по_номеру_стрк(стрк.НомерСтроки);

КонецПроцедуры

// Универсальный метод создания показателя для колонки 12
Процедура СоздатьКолонку12ПоказателиИзТЗ(ТЗ)
	
	Для Счетчик = 0 По ТЗ.Количество()-1 Цикл
		стрк = ТЗ[Счетчик];
				
		Идентификатор = ид(стрк.НомерСтроки, стрк.НомерКолонки);
		ОписаниеПоказателя = "";
		
		СоздатьИлиОбновитьПоказатель(
			Идентификатор,
			Идентификатор,//стрк.НаименованиеПоказателя, 
			Перечисления.хн_нфо_ВидыПоказателейОтчета.РасчетПоФормуле,//стрк.ВидПоказателя, 
			стрк.ТипПоказателяОтчета,
			ОписаниеПоказателя,
			стрк.СписокИспользуемыхПоказателей,
			Неопределено, //стрк.ЗначениеОтбора,
			Истина,//выводить сообщения
			"",//текст кода
			"",//стрк.Формула,
			1//Множитель
			);
		
	КонецЦикла;
	
КонецПроцедуры

// НОВАЯ ГЛАВНАЯ ПРОЦЕДУРА для колонки 12
Процедура СоздатьПоказатели_колонка12_ИзТЗ_Оркестратор()
	
	ТЗ = ПустаяТЗПоказателей();
	Добавить_Показатели_Колонки12_в_ТЗ(ТЗ);
	СоздатьКолонку12ПоказателиИзТЗ(ТЗ);
	
КонецПроцедуры

#КонецОбласти

#Область ПредыдущийПериодОтчета

#Область ПредыдущийПериодОтчета_Детальные

//////////  СТРОКА 2

Функция ВычислитьПоказатель_стр2кол3()

	Префикс = "ГР 19.01_2025, строка 2 колонка 3::";
	ЭтоОстатокНаНачало = Истина;
	СчетСсылка = ПланыСчетов.Хозрасчетный.НайтиПоКоду("60401.ПС");
	ДатаОстатка = НачалоГода(НачалоГода(мНачалоПериода)-1);
	СубконтоСсылка = ГруппаОС_Сооружения(); //массив
	ЗначениеПоказателя = ОстатокПоСчету(мСтруктураПараметров.Организация, СчетСсылка, СубконтоСсылка, ДатаОстатка, ЭтоОстатокНаНачало);
	Сообщить("--------------------------------------------");
	Сообщить(Префикс);
    Сообщить(Префикс+"ЭтоОстатокНаНачало = "+строка(ЭтоОстатокНаНачало));
	Сообщить(Префикс+"СчетСсылка = "+строка(СчетСсылка));
	Сообщить(Префикс+"ДатаОстатка = "+строка(ДатаОстатка));
	Сообщить(Префикс+"СтруктураПараметров.Организация = "+строка(мСтруктураПараметров.Организация));
	Сообщить(Префикс+"Количество субконто в массиве="+строка(СубконтоСсылка.Количество()));
	Сообщить(Префикс+"Значения субконто:");
	для сч = 0 по СубконтоСсылка.Количество()-1 Цикл
		Сообщить(Префикс+"      знч = "+строка(СубконтоСсылка[сч]));
	КонецЦикла;
	Сообщить(Префикс+"ЗначениеПоказателя = "+строка(ЗначениеПоказателя));
	Сообщить("--------------------------------------------");
	
	мЗначениеПоказателя = ЗначениеПоказателя;
	Возврат ЗначениеПоказателя;

КонецФункции

Функция ВычислитьПоказатель_стр2кол4()

	Префикс = "ГР 19.01_2025, строка 2 колонка 4::";
	ЭтоОстатокНаНачало = Истина;
	СчетСсылка = ПланыСчетов.Хозрасчетный.НайтиПоКоду("60401.ПС");
	ДатаОстатка = НачалоГода(НачалоГода(мНачалоПериода)-1);
	СубконтоСсылка = ГруппаОС_ОфисноеОборудование(); //массив
	ЗначениеПоказателя = ОстатокПоСчету(мСтруктураПараметров.Организация, СчетСсылка, СубконтоСсылка, ДатаОстатка, ЭтоОстатокНаНачало);
	Сообщить("--------------------------------------------");
	Сообщить(Префикс);
    Сообщить(Префикс+"ЭтоОстатокНаНачало = "+строка(ЭтоОстатокНаНачало));
	Сообщить(Префикс+"СчетСсылка = "+строка(СчетСсылка));
	Сообщить(Префикс+"ДатаОстатка = "+строка(ДатаОстатка));
	Сообщить(Префикс+"СтруктураПараметров.Организация = "+строка(мСтруктураПараметров.Организация));
	Сообщить(Префикс+"Количество субконто в массиве="+строка(СубконтоСсылка.Количество()));
	Сообщить(Префикс+"Значения субконто:");
	для сч = 0 по СубконтоСсылка.Количество()-1 Цикл
		Сообщить(Префикс+"      знч = "+строка(СубконтоСсылка[сч]));
	КонецЦикла;
	Сообщить(Префикс+"ЗначениеПоказателя = "+строка(ЗначениеПоказателя));
	Сообщить("--------------------------------------------");
	
	мЗначениеПоказателя = ЗначениеПоказателя;
	Возврат ЗначениеПоказателя;

КонецФункции

Функция ВычислитьПоказатель_стр2кол6()

	Префикс = "ГР 19.01_2025, строка 2 колонка 6::";
	ЭтоОстатокНаНачало = Истина;
	СчетСсылка = ПланыСчетов.Хозрасчетный.НайтиПоКоду("60401.ПС");
	ДатаОстатка = НачалоГода(НачалоГода(мНачалоПериода)-1);
	СубконтоСсылка = ГруппаОС_Другие(); //массив
	ЗначениеПоказателя = ОстатокПоСчету(мСтруктураПараметров.Организация, СчетСсылка, СубконтоСсылка, ДатаОстатка, ЭтоОстатокНаНачало);
	Сообщить("--------------------------------------------");
	Сообщить(Префикс);
    Сообщить(Префикс+"ЭтоОстатокНаНачало = "+строка(ЭтоОстатокНаНачало));
	Сообщить(Префикс+"СчетСсылка = "+строка(СчетСсылка));
	Сообщить(Префикс+"ДатаОстатка = "+строка(ДатаОстатка));
	Сообщить(Префикс+"СтруктураПараметров.Организация = "+строка(мСтруктураПараметров.Организация));
	Сообщить(Префикс+"Количество субконто в массиве="+строка(СубконтоСсылка.Количество()));
	Сообщить(Префикс+"Значения субконто:");
	для сч = 0 по СубконтоСсылка.Количество()-1 Цикл
		Сообщить(Префикс+"      знч = "+строка(СубконтоСсылка[сч]));
	КонецЦикла;
	Сообщить(Префикс+"ЗначениеПоказателя = "+строка(ЗначениеПоказателя));
	Сообщить("--------------------------------------------");
	
	мЗначениеПоказателя = ЗначениеПоказателя;
	Возврат ЗначениеПоказателя;

КонецФункции

Функция ВычислитьПоказатель_стр2кол7()

	Префикс = "ГР 19.01_2025, строка 2 колонка 7::";
	ЭтоОстатокНаНачало = Истина;
	СчетСсылка = ПланыСчетов.Хозрасчетный.НайтиПоКоду("60804.ПС");
	ДатаОстатка = НачалоГода(НачалоГода(мНачалоПериода)-1);
	СубконтоСсылка = Неопределено;
	ЗначениеПоказателя = ОстатокПоСчету(мСтруктураПараметров.Организация, СчетСсылка, СубконтоСсылка, ДатаОстатка, ЭтоОстатокНаНачало);
	Сообщить("--------------------------------------------");
	Сообщить(Префикс);
    Сообщить(Префикс+"ЭтоОстатокНаНачало = "+строка(ЭтоОстатокНаНачало));
	Сообщить(Префикс+"СчетСсылка = "+строка(СчетСсылка));
	Сообщить(Префикс+"ДатаОстатка = "+строка(ДатаОстатка));
	Сообщить(Префикс+"СтруктураПараметров.Организация = "+строка(мСтруктураПараметров.Организация));
	Сообщить(Префикс+"ЗначениеПоказателя = "+строка(ЗначениеПоказателя));
	Сообщить("--------------------------------------------");
	
	мЗначениеПоказателя = ЗначениеПоказателя;
	Возврат ЗначениеПоказателя;

КонецФункции

//////////  СТРОКА 3

Функция ВычислитьПоказатель_стр3кол3()

	Префикс = "ГР 19.01_2025, строка 3 колонка 3::";
	ЭтоОстатокНаНачало = Истина;
	СчетСсылка = ПланыСчетов.Хозрасчетный.НайтиПоКоду("60414.ПС");
	ДатаОстатка = НачалоГода(НачалоГода(мНачалоПериода)-1);
	СубконтоСсылка = ГруппаОС_Сооружения(); //массив
	ЗначениеПоказателя = ОстатокПоСчету(мСтруктураПараметров.Организация, СчетСсылка, СубконтоСсылка, ДатаОстатка, ЭтоОстатокНаНачало);
	Сообщить("--------------------------------------------");
	Сообщить(Префикс);
    Сообщить(Префикс+"ЭтоОстатокНаНачало = "+строка(ЭтоОстатокНаНачало));
	Сообщить(Префикс+"СчетСсылка = "+строка(СчетСсылка));
	Сообщить(Префикс+"ДатаОстатка = "+строка(ДатаОстатка));
	Сообщить(Префикс+"СтруктураПараметров.Организация = "+строка(мСтруктураПараметров.Организация));
	Сообщить(Префикс+"Количество субконто в массиве="+строка(СубконтоСсылка.Количество()));
	Сообщить(Префикс+"Значения субконто:");
	для сч = 0 по СубконтоСсылка.Количество()-1 Цикл
		Сообщить(Префикс+"      знч = "+строка(СубконтоСсылка[сч]));
	КонецЦикла;
	Сообщить(Префикс+"ЗначениеПоказателя = "+строка(ЗначениеПоказателя));
	Сообщить("--------------------------------------------");
	
	мЗначениеПоказателя = ЗначениеПоказателя;
	Возврат ЗначениеПоказателя;

КонецФункции

Функция ВычислитьПоказатель_стр3кол4()

	Префикс = "ГР 19.01_2025, строка 3 колонка 4::";
	ЭтоОстатокНаНачало = Истина;
	СчетСсылка = ПланыСчетов.Хозрасчетный.НайтиПоКоду("60414.ПС");
	ДатаОстатка = НачалоГода(НачалоГода(мНачалоПериода)-1);
	СубконтоСсылка = ГруппаОС_ОфисноеОборудование(); //массив
	ЗначениеПоказателя = ОстатокПоСчету(мСтруктураПараметров.Организация, СчетСсылка, СубконтоСсылка, ДатаОстатка, ЭтоОстатокНаНачало);
	Сообщить("--------------------------------------------");
	Сообщить(Префикс);
    Сообщить(Префикс+"ЭтоОстатокНаНачало = "+строка(ЭтоОстатокНаНачало));
	Сообщить(Префикс+"СчетСсылка = "+строка(СчетСсылка));
	Сообщить(Префикс+"ДатаОстатка = "+строка(ДатаОстатка));
	Сообщить(Префикс+"СтруктураПараметров.Организация = "+строка(мСтруктураПараметров.Организация));
	Сообщить(Префикс+"Количество субконто в массиве="+строка(СубконтоСсылка.Количество()));
	Сообщить(Префикс+"Значения субконто:");
	для сч = 0 по СубконтоСсылка.Количество()-1 Цикл
		Сообщить(Префикс+"      знч = "+строка(СубконтоСсылка[сч]));
	КонецЦикла;
	Сообщить(Префикс+"ЗначениеПоказателя = "+строка(ЗначениеПоказателя));
	Сообщить("--------------------------------------------");
	
	мЗначениеПоказателя = ЗначениеПоказателя;
	Возврат ЗначениеПоказателя;

КонецФункции

Функция ВычислитьПоказатель_стр3кол6()

	Префикс = "ГР 19.01_2025, строка 3 колонка 6::";
	ЭтоОстатокНаНачало = Истина;
	СчетСсылка = ПланыСчетов.Хозрасчетный.НайтиПоКоду("60414.ПС");
	ДатаОстатка = НачалоГода(НачалоГода(мНачалоПериода)-1);
	СубконтоСсылка = ГруппаОС_Другие(); //массив
	ЗначениеПоказателя = ОстатокПоСчету(мСтруктураПараметров.Организация, СчетСсылка, СубконтоСсылка, ДатаОстатка, ЭтоОстатокНаНачало);
	Сообщить("--------------------------------------------");
	Сообщить(Префикс);
    Сообщить(Префикс+"ЭтоОстатокНаНачало = "+строка(ЭтоОстатокНаНачало));
	Сообщить(Префикс+"СчетСсылка = "+строка(СчетСсылка));
	Сообщить(Префикс+"ДатаОстатка = "+строка(ДатаОстатка));
	Сообщить(Префикс+"СтруктураПараметров.Организация = "+строка(мСтруктураПараметров.Организация));
	Сообщить(Префикс+"Количество субконто в массиве="+строка(СубконтоСсылка.Количество()));
	Сообщить(Префикс+"Значения субконто:");
	для сч = 0 по СубконтоСсылка.Количество()-1 Цикл
		Сообщить(Префикс+"      знч = "+строка(СубконтоСсылка[сч]));
	КонецЦикла;
	Сообщить(Префикс+"ЗначениеПоказателя = "+строка(ЗначениеПоказателя));
	Сообщить("--------------------------------------------");
	
	мЗначениеПоказателя = ЗначениеПоказателя;
	Возврат ЗначениеПоказателя;

КонецФункции

Функция ВычислитьПоказатель_стр3кол7()

	Префикс = "ГР 19.01_2025, строка 3 колонка 7::";
	ЭтоОстатокНаНачало = Истина;
	СчетСсылка = ПланыСчетов.Хозрасчетный.НайтиПоКоду("60805.ПС");
	ДатаОстатка = НачалоГода(НачалоГода(мНачалоПериода)-1);
	СубконтоСсылка = Неопределено;
	ЗначениеПоказателя = ОстатокПоСчету(мСтруктураПараметров.Организация, СчетСсылка, СубконтоСсылка, ДатаОстатка, ЭтоОстатокНаНачало);
	Сообщить("--------------------------------------------");
	Сообщить(Префикс);
    Сообщить(Префикс+"ЭтоОстатокНаНачало = "+строка(ЭтоОстатокНаНачало));
	Сообщить(Префикс+"СчетСсылка = "+строка(СчетСсылка));
	Сообщить(Префикс+"ДатаОстатка = "+строка(ДатаОстатка));
	Сообщить(Префикс+"СтруктураПараметров.Организация = "+строка(мСтруктураПараметров.Организация));
	Сообщить(Префикс+"ЗначениеПоказателя = "+строка(ЗначениеПоказателя));
	Сообщить("--------------------------------------------");
	
	мЗначениеПоказателя = ЗначениеПоказателя;
	Возврат ЗначениеПоказателя;

КонецФункции

#КонецОбласти

#Область ПредыдущийПериодОтчета_ГРУППИРОВОЧНЫЕ

#КонецОбласти

ИмяГруппы = "ГР_19.01_2025";

//СоздатьОбновитьПоказатели(Истина);
СоздатьВсеДетальныеПоказателиИзТЗ_Оркестратор();
 СоздатьПоказатели_колонка12_ИзТЗ_Оркестратор();

