# Инструкция по установке и использованию

## Быстрый старт

### 1. Создание обработки в конфигураторе 1С

1. **Откройте конфигуратор 1С 8.3**
2. **Создайте новую внешнюю обработку:**
   - Конфигурация → Внешние обработки → Создать
   - Имя: `ГрафикРабот`
   - Синоним: `График работ`

### 2. Настройка модуля объекта

1. **Откройте модуль объекта** обработки
2. **Скопируйте содержимое** файла `ГрафикРабот_МодульОбъекта.bsl`
3. **Вставьте в модуль объекта** обработки

### 3. Создание макета

1. **Добавьте макет** в обработку:
   - Правый клик на обработке → Вставить → Макет
   - Имя: `ШаблонГрафикаРабот`
   - Тип: `Макет табличного документа`
2. **Откройте макет** и создайте структуру таблицы:
   - **Строка 1-2**: Заголовки (объединенные ячейки)
   - **Строка 3**: Нумерация колонок (1-8)
   - **Строка 4**: Область данных `СтрокаДанных`

### 4. Создание формы

1. **Добавьте форму** в обработку:
   - Правый клик на обработке → Вставить → Форма
   - Имя: `Форма`
2. **Настройте элементы формы:**
   - **Надпись**: "График работ на основе таблицы ГР_12.02_2025"
   - **Поле табличного документа**: привязанное к реквизиту `ТабличныйДокумент`
3. **Добавьте команды:**
   - `СформироватьОтчет` - сформировать отчет
   - `ОчиститьОтчет` - очистить
   - `ОИнформации` - о программе

### 5. Настройка модуля формы

1. **Откройте модуль формы**
2. **Скопируйте содержимое** файла `ГрафикРабот_МодульФормы.bsl`
3. **Вставьте в модуль формы**

## Использование обработки

### В режиме 1С:Предприятие

1. **Загрузите обработку:**
   - Файл → Открыть → Выберите .epf файл
2. **Работайте с данными:**
   - Нажмите **"Сформировать отчет"** для создания таблицы
   - Используйте **"Очистить"** для очистки
   - **"О программе"** покажет информацию об обработке

### Программный интерфейс

```bsl
// Создание экземпляра обработки
ВнешняяОбработка = ВнешниеОбработки.Создать("ГрафикРабот");

// Получение версии
Версия = ВнешняяОбработка.ПолучитьВерсию();

// Создание табличного документа
ТабДокумент = ВнешняяОбработка.СоздатьТабличныйДокумент(Истина);

// Экспорт в Excel
Результат = ВнешняяОбработка.ЭкспортироватьВExcel("C:\Temp\График.xlsx", Истина);

// Получение данных для обмена
ДанныеОбмена = ВнешняяОбработка.ПолучитьДанныеДляОбмена(Истина);
```

## Структура данных

Таблица содержит следующие колонки:

| № | Наименование | Тип данных | Описание |
|---|--------------|------------|----------|
| 1 | НомерСтроки | Число | Порядковый номер |
| 2 | НаименованиеПоказателя | Строка | Описание работы |
| 3 | ВсегоЧасов | Число | Общее количество часов |
| 4 | Период1 | Число | Часы по 1-му периоду |
| 5 | Период2 | Число | Часы по 2-му периоду |
| 6 | Период3 | Число | Часы по 3-му периоду |
| 7 | ЧасыПоПериодам | Число | Сумма по периодам |
| 8 | Итого | Число | Итоговые часы |

## Диагностика

Все методы поддерживают диагностическое логирование. Передайте `Истина` в параметре `ВыводитьСообщения` для получения подробной информации о выполнении операций.

## Возможные проблемы

1. **Макет не найден** - проверьте имя макета `ШаблонГрафикаРабот`
2. **Ошибка области** - убедитесь, что область `СтрокаДанных` определена в макете
3. **Нет прав на файл** - проверьте права доступа при экспорте в Excel

---
*Дата создания инструкции: 18.09.2025*
